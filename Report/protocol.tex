\chapter{Protocol}

\section{Objectives}
\begin{equation}
	S \mid\equiv C \stackrel{ K_{cs} }\longleftrightarrow S
\end{equation}

\begin{equation}
	S \mid\equiv C \mid\equiv (C \stackrel{ K_{cs} }\longleftrightarrow S)
\end{equation}

\begin{equation}
	C \mid\equiv S \mid\equiv (C \stackrel{ K_{cs} }\longleftrightarrow S)
\end{equation}

\section{Real Protocol}
%the one below is the first message composed by the Server nonce
\begin{equation}
M1:  S \rightarrow C:  N_{s}
\end{equation}
%this is the second message sent by the client
\begin{equation}
M2:  C \rightarrow S: \{ N_{s}, N_{c}, C \stackrel{ K_{cs} }\longleftrightarrow S, h( Q ) \}_{K_{s}}
\end{equation}
%and now we have the last message
\begin{equation}
M3:  S \rightarrow S: \{ N_{c} - 1 \}_{K_{cs}}
\end{equation}

\section{Assumption}

\noindent
$
\stackrel{ K_{s} }\mapsto S
$

\noindent
$
C \stackrel{ Q }\rightleftharpoons S
$

\noindent
$
C \Rightarrow ( C \stackrel{ K_{cs} }\longleftrightarrow S )
$

\noindent
$
C \mid\equiv ( C \stackrel{ K_{cs} }\longleftrightarrow S )
$

\noindent
$
C \mid\equiv \#( N_{c} )
$

\noindent
$
S \mid\equiv \#( N_{s} )
$

\section{Idealized Protocol}

\noindent
\begin{equation}
M1: S \rightarrow C:  N_{s}
\end{equation}


\noindent
%this is the second message sent by the client
\begin{equation}
M2: C \rightarrow S: \{ N_{s}, N_{c}, C \stackrel{ K_{cs} }\longleftrightarrow S, C \stackrel{ Q }\rightleftharpoons S  \}_{K_{s}}
\end{equation}
 
%and now we have the last message
\begin{equation}
M3: S \rightarrow C: \{ N_{c} - 1, C \stackrel{ K_{cs} }\longleftrightarrow S \}_{K_{cs}}
\end{equation}

\section{Demonstration}

\subsection{After M2}
\begin{equation}
\frac{ 
	S \mid\equiv S \stackrel{ Q }\rightleftharpoons C, S \triangleleft  \langle S \stackrel {K_{cs}}\longleftrightarrow C \rangle_{ Q } 
 }
 {
	S \mid\equiv C \mid\sim S \stackrel {K_{cs}}\longleftrightarrow C
 }
\end{equation}

\begin{equation}
\frac{
	S \mid\equiv \#( N_{s} ), S \mid\equiv ( C \mid\sim S \stackrel {K_{cs}}\longleftrightarrow C )
}
{
 S \mid\equiv C \mid\equiv ( C \stackrel {K_{cs}}\longleftrightarrow S )
}
\end{equation}

\emph{One objective reached}

\begin{equation}
\frac{
	 S \mid\equiv (C \Rightarrow C \stackrel {K_{cs}}\longleftrightarrow S ), S \mid\equiv C \mid\equiv (C \stackrel {K_{cs}}\longleftrightarrow S)
}
{
	S \mid\equiv ( C \stackrel {K_{cs}}\longleftrightarrow S )
}
\end{equation}

\emph{Another objective reached}


\subsection{After M3}

\begin{equation}
\frac{
	C \mid\equiv ( C \stackrel {K_{cs}}\longleftrightarrow S ), C \triangleleft \{ N_{c}, C \stackrel {K_{cs}}\longleftrightarrow S \} 
}
{
	C \mid\equiv S \mid\sim ( N_{c}, C \stackrel {K_{cs}}\longleftrightarrow S )  
}
\end{equation}

\begin{equation}
\frac{
	C \mid\equiv \#(N_{c}), C \mid\equiv S  \mid\sim ( N_{c}, C \stackrel {K_{cs}}\longleftrightarrow S )
}
{
	C \mid\equiv S \mid\equiv ( C \stackrel {K_{cs}}\longleftrightarrow S )
}
\end{equation}

\emph{All objects reached}
